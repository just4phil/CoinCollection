name: Firebase Hosting Deployment

# Löst den Workflow bei jedem Push auf den 'main' Branch aus
on:
  push:
    branches:
      - main

# Ermöglicht das Klonen des Repositories
permissions:
  contents: read

jobs:
  deploy:
    # Führt den Job auf dem neuesten Ubuntu-Runner aus
    runs-on: ubuntu-latest
    steps:
      - name: Code auschecken
        uses: actions/checkout@v4

      - name: Firebase CLI installieren
        # Da wir nur Hosting nutzen und kein Build-Step (wie bei React) haben, ist die Installation ausreichend.
        run: npm install -g firebase-tools

      - name: Deployment auf Firebase Hosting durchführen
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
        # Your Firebase Project ID
        projectId: coincollection-9ae5e 
        channelId: live
    env:
      # SOLUTION: Passes the CI token to the Firebase CLI, solving the authentication error
      FIREBASE_CLI_AUTH_TOKEN: ${{ secrets.FIREBASE_TOKEN }}